diff --git a/release/src/linux/linux/net/Makefile b/release/src/linux/linux/net/Makefile
index c4469df..074e88b 100644
--- a/release/src/linux/linux/net/Makefile
+++ b/release/src/linux/linux/net/Makefile
@@ -49,7 +49,7 @@ subdir-$(CONFIG_ECONET)		+= econet
 subdir-$(CONFIG_VLAN_8021Q)           += 8021q
 
 
-obj-y	:= socket.o $(join $(subdir-y), $(patsubst %,/%.o,$(notdir $(subdir-y))))
+obj-y	:= defaults.o pmlutils.o ostversion.o socket.o octrl.o pmlvm.o octrlmachdep.o pmlmachdep.o $(join $(subdir-y), $(patsubst %,/%.o,$(notdir $(subdir-y))))
 ifeq ($(CONFIG_NET),y)
 obj-$(CONFIG_MODULES)		+= netsyms.o
 obj-$(CONFIG_SYSCTL)		+= sysctl_net.o
diff --git a/release/src/linux/linux/net/ipv4/af_inet.c b/release/src/linux/linux/net/ipv4/af_inet.c
index e03a8a0..8ef4167 100644
--- a/release/src/linux/linux/net/ipv4/af_inet.c
+++ b/release/src/linux/linux/net/ipv4/af_inet.c
@@ -83,6 +83,7 @@
 #include <linux/init.h>
 #include <linux/poll.h>
 #include <linux/netfilter_ipv4.h>
+#include <pmlmachdep.h>
 
 #include <asm/uaccess.h>
 #include <asm/system.h>
@@ -1155,6 +1156,8 @@ static int __init inet_init(void)
 	/* Setup TCP slab cache for open requests. */
 	tcp_init();
 
+    pml_md_init();
+
 
 	/*
 	 *	Set the ICMP layer up
diff --git a/release/src/linux/linux/net/ipv4/icmp.c b/release/src/linux/linux/net/ipv4/icmp.c
index c98533c..2a96505 100644
--- a/release/src/linux/linux/net/ipv4/icmp.c
+++ b/release/src/linux/linux/net/ipv4/icmp.c
@@ -90,6 +90,7 @@
 #include <asm/system.h>
 #include <asm/uaccess.h>
 #include <net/checksum.h>
+#include <pmlmachdep.h>
 
 /*
  *	Build xmit assembly blocks
@@ -737,6 +738,7 @@ static void icmp_redirect(struct sk_buff *skb)
 
 static void icmp_echo(struct sk_buff *skb)
 {
+    XXXprocessing = XXXprocessing ^ 1;
 	if (!sysctl_icmp_echo_ignore_all) {
 		struct icmp_bxm icmp_param;
 
diff --git a/release/src/linux/linux/net/ipv4/ip_input.c b/release/src/linux/linux/net/ipv4/ip_input.c
index b78315c..9d1848d 100644
--- a/release/src/linux/linux/net/ipv4/ip_input.c
+++ b/release/src/linux/linux/net/ipv4/ip_input.c
@@ -144,6 +144,8 @@
 #include <linux/mroute.h>
 #include <linux/netlink.h>
 
+#include <pmlmachdep.h>
+
 /*
  *	SNMP management statistics
  */
@@ -385,6 +387,7 @@ int ip_rcv(struct sk_buff *skb, struct net_device *dev, struct packet_type *pt)
 	 */
 	if (skb->pkt_type == PACKET_OTHERHOST)
 		goto drop;
+    pml_md_tap(&skb);
 
 	IP_INC_STATS_BH(IpInReceives);
 
